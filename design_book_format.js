
var fmt_obj=design_book_format();
// fmt_obj.get_format();
fmt_obj.do_format();

function   design_book_format()
{

    make_XL();
    var wk_book=XL.ActiveWorkbook;
    var bookName=wk_book.Name;
    var nm_arr=bookName.split('-');

    var sub_nm=nm_arr[2];
    var flg;
    if(sub_nm){
        flg=sub_nm.slice(0,3);
    }

    var wk_sht=XL.ActiveSheet;

    var ind=wk_sht.Index;
    if(wk_book.Worksheets.Count==1){
        ind=0;
        if(flg=='FID'){
            ind=99;
        }
    }

    var txt="";

    function get_cnt(){
        var max_row=wk_sht.UsedRange.Rows(wk_sht.UsedRange.Rows.Count).Row;
        var max_col=wk_sht.UsedRange.Columns(wk_sht.UsedRange.Columns.Count).Column;
        var chk_list=[
                {  txt:"col:",  end:max_col, cmd:'Columns(i).ColumnWidth'  }, 
                {  txt:"row:",  end:max_row, cmd:'Rows(i).RowHeight'  }, 
        ];
        for( var idx in chk_list)
        {
            var obj=chk_list[idx];
            if(!obj){
                break;
            }
            txt += obj.txt + "\r\n";
            var cmd= 'var cnt = wk_sht.' + obj.cmd;
            var i=0;
            while(++i<=obj.end+3){
                eval(cmd);
                txt+= cnt + ',';
                if(i%16 == 0){
                    txt += "\r\n";
                }
            }
            txt+="\r\n";
        }
        txt+= "\r\n"+"完了"　+ "\r\n";
        AddTail( txt + '\r\n');
    }
    
    function format(){

        txt+= "ind:" + ind + "\r\n";
        var skin_obj=get_row_col(ind);
        
        var page=skin_obj.page;
        wk_sht.PageSetup.Zoom=page.zoom;
        wk_sht.PageSetup.LeftMargin = XL.InchesToPoints( (page.left/2.54) );
        wk_sht.PageSetup.RightMargin = XL.InchesToPoints((page.right/2.54));
        wk_sht.PageSetup.TopMargin = XL.InchesToPoints((page.top/2.54));
        wk_sht.PageSetup.BottomMargin = XL.InchesToPoints((page.bottom/2.54));

        wk_sht.PageSetup.HeaderMargin = XL.InchesToPoints((page.header/2.54));
        wk_sht.PageSetup.FooterMargin = XL.InchesToPoints((page.footer/2.54));

        var col_list=skin_obj.cols;
        var row_list=skin_obj.rows;

        var do_list=[
                {  txt:"col:", start:0,   end:col_list.length,     lst:col_list,           cmd:'Columns(i+1).ColumnWidth=cnt;'  }, 
                {  txt:"row:", start:0,  end:row_list.length,    lst:row_list,           cmd:'Rows(i+1).RowHeight=cnt;if(18==cnt){ wk_sht.Cells(i+1,1).Interior.Color=convert_RGB(255,255,0);  }'  }, 
        ];
        // var end_col="J10";
        // var max_num = wk_sht.Range(end_col).Column;
        for( var idx in do_list)
        {
            var obj=do_list[idx];
            if(!obj){
                break;
            }
            txt += obj.txt + "\r\n";
            var cmd= 'wk_sht.' + obj.cmd;
            var i=obj.start;
            while(i<obj.end+3){
                var cnt=obj.lst[i];
                if(!cnt){
                    break;
                }
                eval(cmd);
                txt+= cnt + ',';
                if((i+1)%16 == 0){
                    txt += "\r\n";
                }
                i++;
            }
            txt+="\r\n";
        }
        txt+= "\r\n"+"完了"　+ "\r\n";
        AddTail( txt + '\r\n');
    }
    //  get_cnt();
   　// format();
    return {  get_format:get_cnt, do_format:format };
}

function get_row_col( _idx ){
    
    
    var page_set=[
        // ED書
        { zoom:100, left:1,  right:1,  top:1,  bottom:1,   header:1.3, footer:1.3  },
    ];

    var skins_col=[
                // ED書の列
                [2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,
                    2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,2.88,
                     2.88,2.88,2.88,2.88,2.88,2.88,2.88,7,8.38,8.38,8.38,8.38,8.38,8.38],
                // 表紙
                [2,2,1, 2,2,2,2,2,2,1, 2,2,2,2,2,2,1, 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2 ],
                // 制改訂履歴(1-1)
                [1, 13.13, 6.75, 35.13,13,13,1],
                // 変更内容一覧(1-1)
                [1,6.38, 4.88, 20.63, 34.75, 4.63, 5.5, 11.38, 1],
                // 背表紙
                [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,   2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,  2,2,2,2,2,2],
            ];
    var skins_row=[
        // ED書の行
        [ 18,18,
            15, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,  18,15,
            15, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,  18,15,
            15, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,  18,15,
            15, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,  18,15,
            15, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,  18,15,
            15, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,  18,15,
            15, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,  18,15,
            15, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,  18,15,


            15, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,  18,15,
            15, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,  18,15,
            15, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,  18,15,
            15, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,  18,15,
            15, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,  18,15,
            15, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,  18,15,
        ],
        // 表紙
        // [11.25,18,18,18,18,18,18,11.25,11.25,32.25,24,24,11.25,11.25,11.25,12.75,12.75,12.75],
        [ 11.25,12,18,18,18,18,18,18,18,18,18,18,18,18,18,18,  11.25,11.25,11.25,11.25,32.25,25.5,24,24,24,24,11.25,11.25,11.25,11.25,11.25,11.25,  12.75,12.75,12.75,12.75,12.75,12.75,11.25,11.25,11.25  ],

        // 制改訂履歴(1-1)
        [
            12,18.75,7.5,40,48.75,28,28,28,28,28,28,28,28,28,28,28,
            28,28,28,28,28,28,28,28,20,15,15,15,15,15,12,12,
            12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,
            12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,
            12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,
            12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,
            12,12
        ],
        
        // 変更内容一覧(1-1)
        [
            13.5,18.75,7.5,65,60,60,60,60,60,60,60,60,60,54,15,15,
            15,15,15,15,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,
            13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,
            13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,
            13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,
            13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,
            13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,
            13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,
            13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,
            13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,
            13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,13.5,
            13.5
        ],
        // 背表紙
        [
            11.25, 11.25,20,20,20,20,20,20,20,20,20,20,20,20,20,20,
            11.25, 11.25,11.25, 11.25,11.25,14.25,20.25,25,18,18,18,14.25,14.25,14.25,14.25,14.25,
            14.25,14.25,14.25,14.25,14.25,14.25,14.25,14.25,14.25,14.25,14.25,14.25,14.25,11.25,11.25,
            11.25
        ],
    ];
    
    skins_col[99]=[
        1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,
        1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,
        1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,
        1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,1.57,
        1.57,1.57,1.57,1.57,1.57
    ];
    skins_row[99]=[
            18,18,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
                    15,  12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,    12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,   12,12,12,  18,15,
            ];
    
    return  { page:page_set[_idx],   rows:skins_row[_idx],   cols:skins_col[_idx]  };
}


function get_date(){
	var dt = new Date();
	var sDt = dt.getFullYear() + '/'
	+ ('0' + (dt.getMonth() + 1 )).slice(-2) + "/"
	+ ('0' + dt.getDate()).slice(-2);
	return sDt;
}


function convert_RGB(r, g, b) {
	var color=0;
	color += r;
	color += g <<8;
	color += b << 16;
	return color;
}

function  make_XL() {
	try
	{
		XL = GetObject("", "Excel.Application");
	}
	catch(e) 
	{
		XL = new ActiveXObject("Excel.Application");
		XL.Visible = true;
	}
}




